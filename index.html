<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‹—ç‹—äººé¡å¹´é½¡æ›ç®—å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/png" href="./icon.png">
    <link rel="apple-touch-icon" href="./icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./icon.png">
    <style>
        /* è¨­å®šå­—é«”ç‚º Interï¼Œä¸¦ç¢ºä¿ä¸­æ–‡é¡¯ç¤ºæ­£å¸¸ */
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background: linear-gradient(135deg, #87CEEB 0%, #B0E0E6 50%, #E0F6FF 100%);
            /* æ°´è—è‰²æ¼¸å±¤èƒŒæ™¯ */
            min-height: 100vh;
        }
    </style>
    <script>
        // ç‹—ç‹—å¹´é½¡æ›ç®—è¡¨ (åŸºæ–¼ç”¨æˆ¶æä¾›çš„åŸå§‹æ•¸æ“š)
        // æ³¨æ„ï¼šæ­¤è™•æ•¸æ“šåˆ—çš„é †åºä¿æŒä¸è®Šï¼š
        // æ¬„ä½é †åº: [ç‹—ç‹—å¹´é½¡, åŸå§‹è¶…å°å‹çŠ¬æ•¸æ“š, åŸå§‹å°å‹çŠ¬æ•¸æ“š, åŸå§‹ä¸­å‹çŠ¬æ•¸æ“š, åŸå§‹å¤§å‹çŠ¬æ•¸æ“š]
        // ä½† getSizeCategory å‡½æ•¸å°‡æ ¹æ“šæ–°çš„é«”é‡åˆ†é¡ï¼Œå°‡é«”é‡å°æ‡‰åˆ°é€™äº›æ•¸æ“šåˆ—ã€‚
        // è«‹ç¢ºä¿æ‚¨çš„æ•¸æ“šèˆ‡å¯¦éš›é«”é‡åˆ†é¡æ˜¯åŒ¹é…çš„ã€‚
        // åŸæœ¬: [å¹´é½¡, â‰¤ 4.5kg, 4.6-9kg, 9.1-22kg, > 22kg]
        const CONVERSION_TABLE = [
            [1, 15, 15, 15, 12],
            [2, 24, 24, 24, 22],
            [3, 28, 28, 28, 31],
            [4, 32, 32, 32, 38],
            [5, 36, 36, 36, 45],
            [6, 40, 42, 45, 49],
            [7, 44, 47, 50, 56],
            [8, 48, 51, 55, 64],
            [9, 52, 56, 61, 71],
            [10, 56, 60, 66, 79],
            [11, 60, 65, 72, 86],
            [12, 64, 69, 77, 93],
            [13, 68, 74, 82, 100],
            [14, 72, 78, 88, 107],
            [15, 76, 83, 93, 114],
            [16, 80, 87, 99, 121],
        ];

        // é¡¯ç¤ºé€šçŸ¥/éŒ¯èª¤è¨Šæ¯çš„é€šç”¨å‡½æ•¸
        function showNotification(message, type = 'error') {
            const notificationDiv = document.getElementById('notification');

            // ç§»é™¤æ‰€æœ‰èˆŠçš„é¡è‰²é¡åˆ¥
            notificationDiv.classList.remove('bg-red-100', 'text-red-800', 'bg-blue-100', 'text-blue-800', 'hidden');

            if (type === 'error') {
                notificationDiv.classList.add('bg-red-100', 'text-red-800');
            } else if (type === 'info') {
                notificationDiv.classList.add('bg-blue-100', 'text-blue-800');
            }

            notificationDiv.textContent = message;
            notificationDiv.classList.remove('hidden');

            // è¨Šæ¯é¡¯ç¤º 5 ç§’å¾Œè‡ªå‹•éš±è—
            setTimeout(() => {
                notificationDiv.classList.add('hidden');
            }, 5000);
        }

        // æ ¹æ“šé«”é‡ (å…¬æ–¤) ç¢ºå®šç‹—ç‹—çš„é«”å‹åˆ†é¡å’Œå°æ‡‰çš„è¡¨æ ¼æ¬„ä½ç´¢å¼•
        // *** æ­¤è™•å·²ä¿®æ­£ç‚ºæ–°çš„é«”é‡åˆ†ç´šæ¨™æº– ***
        function getSizeCategory(weight) {

            if (weight === null || weight <= 0) {
                showNotification("è«‹è¼¸å…¥æœ‰æ•ˆçš„é«”é‡ï¼", 'error');
                return null;
            } else if (weight <= 9.0) {
                // è¶…å°å‹çŠ¬ (Tiny) - å°æ‡‰åŸå§‹è¡¨æ ¼ä¸­çš„æ•¸æ“šæ¬„ä½ç´¢å¼• 1
                return { name: "è¶…å°å‹çŠ¬ (â‰¤ 9.0 kg)", index: 1, lifespan: { min: 10, max: 15 } };
            } else if (weight <= 23.0) {
                // ä¸­å‹çŠ¬ (Small) - å°æ‡‰åŸå§‹è¡¨æ ¼ä¸­çš„æ•¸æ“šæ¬„ä½ç´¢å¼• 2
                return { name: "ä¸­å‹çŠ¬ (9.1 - 23.0 kg)", index: 2, lifespan: { min: 10, max: 13 } };
            } else if (weight <= 45.0) {
                // å¤§å‹çŠ¬ (Medium) - å°æ‡‰åŸå§‹è¡¨æ ¼ä¸­çš„æ•¸æ“šæ¬„ä½ç´¢å¼• 3
                return { name: "å¤§å‹çŠ¬ (23.1 - 45.0 kg)", index: 3, lifespan: { min: 10, max: 12 } };
            } else {
                // å·¨å‹çŠ¬ (Large) - å°æ‡‰åŸå§‹è¡¨æ ¼ä¸­çš„æ•¸æ“šæ¬„ä½ç´¢å¼• 4
                return { name: "å·¨å‹çŠ¬ (> 45.0 kg)", index: 4, lifespan: { min: 8, max: 10 } };
            }
        }

        // æª¢æŸ¥ç‹—ç‹—æ˜¯å¦è¶…éå¹³å‡å£½å‘½ä¸¦ç”Ÿæˆç›¸æ‡‰æç¤º
        function getLifespanWarning(dogAge, sizeCategory) {
            const { min, max } = sizeCategory.lifespan;
            const avgLifespan = (min + max) / 2;

            if (dogAge >= max) {
                return `<div class="mt-3 p-3 bg-orange-50 border-l-4 border-orange-400 rounded-r-lg">
                    <p class="text-orange-700 text-sm font-medium flex items-center">
                        <span class="text-2xl mr-2">ğŸ•â€ğŸ¦º</span>
                        æ‚¨çš„ç‹—ç‹—å·²ç¶“æ˜¯é«˜é½¡çŠ¬äº†ï¼${sizeCategory.name.split(' ')[0]}çš„å¹³å‡å£½å‘½ç‚º ${min}-${max} å¹´ï¼Œè«‹ç‰¹åˆ¥æ³¨æ„å¥åº·ç…§è­·ã€‚
                    </p>
                </div>`;
            } else if (dogAge >= avgLifespan) {
                return `<div class="mt-3 p-3 bg-yellow-50 border-l-4 border-yellow-400 rounded-r-lg">
                    <p class="text-yellow-700 text-sm font-medium flex items-center">
                        <span class="text-2xl mr-2">ğŸ•</span>
                        æ‚¨çš„ç‹—ç‹—å·²é€²å…¥ä¸­è€å¹´æœŸï¼${sizeCategory.name.split(' ')[0]}çš„å¹³å‡å£½å‘½ç‚º ${min}-${max} å¹´ï¼Œå»ºè­°å®šæœŸå¥åº·æª¢æŸ¥ã€‚
                    </p>
                </div>`;
            }
            return '';
        }

        // è¨ˆç®—ç‹—ç‹—çš„å¯¦éš›å¹´é½¡ (ä»¥è¶³æ­²è¨ˆ)
        function calculateDogAge(birthDateString) {
            const today = new Date();
            const birthDate = new Date(birthDateString);

            if (birthDate > today) {
                showNotification("å‡ºç”Ÿæ—¥æœŸä¸èƒ½æ™šæ–¼ä»Šå¤©ï¼", 'error');
                return null;
            }

            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDifference = today.getMonth() - birthDate.getMonth();
            const dayDifference = today.getDate() - birthDate.getDate();

            // å¦‚æœæœˆä»½å·®å°æ–¼ 0ï¼Œæˆ–è€…æœˆä»½å·®ç­‰æ–¼ 0 ä½†æ—¥æœŸå·®å°æ–¼ 0ï¼Œå‰‡å¹´é½¡æ¸› 1
            if (monthDifference < 0 || (monthDifference === 0 && dayDifference < 0)) {
                age--;
            }

            return age;
        }

        // ä¸»è¦è¨ˆç®—å‡½æ•¸
        function calculateHumanAge(event) {
            event.preventDefault(); // é˜»æ­¢è¡¨å–®æäº¤

            const birthDateInput = document.getElementById('birthDate').value;
            const weightInput = document.getElementById('weight').value;
            const resultDiv = document.getElementById('result');

            // æ¸…ç©ºçµæœå’Œéš±è—é€šçŸ¥
            resultDiv.innerHTML = '';
            document.getElementById('notification').classList.add('hidden');


            if (!birthDateInput || !weightInput) {
                showNotification("è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½ï¼šå‡ºç”Ÿæ—¥æœŸå’Œé«”é‡ã€‚", 'error');
                return;
            }

            const dogAge = calculateDogAge(birthDateInput);
            const weight = parseFloat(weightInput);
            const sizeCategory = getSizeCategory(weight);

            if (dogAge === null || sizeCategory === null) {
                // éŒ¯èª¤å·²åœ¨å­å‡½æ•¸ä¸­é¡¯ç¤º
                return;
            }

            // æŸ¥æ‰¾æ›ç®—è¡¨
            let humanAge = null;
            let dogAgeKey = Math.min(dogAge, 16); // è¡¨æ ¼ä¸Šé™ç‚º 16 æ­²
            let tableRow = CONVERSION_TABLE.find(row => row[0] === dogAgeKey);

            if (tableRow) {
                // sizeCategory.index ç¾åœ¨æ˜¯æ ¹æ“šæ–°é«”é‡åˆ†é¡å¾—å‡ºçš„ç´¢å¼•ï¼Œç”¨æ–¼æŸ¥æ‰¾åŸå§‹æ•¸æ“š
                humanAge = tableRow[sizeCategory.index];
            } else if (dogAgeKey === 0) {
                // 0 æ­² (æœªæ»¿ 1 æ­²) è™•ç†ï¼šå‡è¨­ç‚º 0 æ­²äººé¡å¹´é½¡ï¼Œæˆ–æä¾›ä¸€å€‹æé†’ã€‚
                humanAge = "æœªæ»¿ 1 æ­²ï¼Œç„¡æ³•æº–ç¢ºæ›ç®—ã€‚";
            } else {
                // ç†è«–ä¸Šä¸æœƒç™¼ç”Ÿï¼Œå› ç‚ºå·²ä½¿ç”¨ Math.min(dogAge, 16)
                humanAge = "ç„¡æ³•è¨ˆç®—ã€‚";
            }

            let ageNote = '';
            if (dogAge > 16) {
                // å¦‚æœç‹—ç‹—è¶…é 16 æ­²ï¼Œä½¿ç”¨ 16 æ­²çš„æ•¸æ“šä¸¦åŠ ä¸Šèªªæ˜
                ageNote = `<p class="text-sm text-yellow-600 mt-2">æ³¨æ„ï¼šæ‚¨çš„ç‹—ç‹—å·² ${dogAge} æ­²ã€‚ç”±æ–¼è¡¨æ ¼è³‡æ–™ä¸Šé™ç‚º 16 æ­²ï¼Œæˆ‘å€‘ä½¿ç”¨ 16 æ­²çš„æ›ç®—å€¼ (${humanAge} æ­²) ä½œç‚ºåƒè€ƒã€‚</p>`;
            } else if (dogAge === 0 && typeof humanAge === 'string') {
                // è™•ç†æœªæ»¿ 1 æ­²çš„ç‰¹åˆ¥è¨Šæ¯
                ageNote = `<p class="text-sm text-yellow-600 mt-2">æç¤ºï¼šæ‚¨çš„ç‹—ç‹—æœªæ»¿ 1 æ­²ã€‚è¡¨æ ¼åƒ…æä¾›è¶³æ­²æ›ç®—ï¼Œå¯¦éš›æ›ç®—è«‹è«®è©¢ç¸é†«ã€‚</p>`;
            }

            // ç²å–å£½å‘½è­¦å‘Š
            const lifespanWarning = getLifespanWarning(dogAge, sizeCategory);

            // é¡¯ç¤ºçµæœ
            if (humanAge !== null) {
                const ageText = typeof humanAge === 'number' ? `${humanAge} æ­²` : humanAge;

                // æ ¹æ“šå¹´é½¡æ·»åŠ é©ç•¶çš„ç‹—ç‹—åœ–ç¤º
                let dogIcon = 'ğŸ¶'; // é è¨­å¹´è¼•ç‹—ç‹—
                if (dogAge >= sizeCategory.lifespan.max) {
                    dogIcon = 'ğŸ•â€ğŸ¦º'; // é«˜é½¡çŠ¬
                } else if (dogAge >= (sizeCategory.lifespan.min + sizeCategory.lifespan.max) / 2) {
                    dogIcon = 'ğŸ•'; // ä¸­è€å¹´çŠ¬
                }

                resultDiv.innerHTML = `
                    <div class="p-6 bg-white border-2 border-blue-500 rounded-xl shadow-lg transition-all duration-300">
                        <p class="text-xl font-semibold text-gray-600 mb-2 flex items-center">
                            <span class="text-2xl mr-2">${dogIcon}</span>
                            ç‹—ç‹—è³‡è¨Šç¸½çµï¼š
                        </p>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>å¯¦éš›å¹´é½¡ (è¶³æ­²)ï¼š<strong class="text-blue-600">${dogAge} æ­²</strong></li>
                            <li>é«”é‡åˆ†é¡ï¼š<strong class="text-blue-600">${sizeCategory.name} (${weight.toFixed(1)} å…¬æ–¤)</strong></li>
                            <li>å¹³å‡å£½å‘½ï¼š<strong class="text-blue-600">${sizeCategory.lifespan.min}-${sizeCategory.lifespan.max} å¹´</strong></li>
                        </ul>
                        <hr class="my-4 border-blue-200">
                        <p class="text-3xl font-extrabold text-center text-blue-700">
                            ç›¸ç•¶æ–¼äººé¡å¹´é½¡ï¼š<br>
                            <span class="text-5xl">${ageText}</span>
                        </p>
                        ${ageNote}
                        ${lifespanWarning}
                    </div>
                `;
            }
        }

        // åœ¨é é¢è¼‰å…¥å®Œæˆå¾Œï¼Œå°‡è¨ˆç®—å‡½æ•¸ç¶å®šåˆ°è¡¨å–®æäº¤äº‹ä»¶
        window.onload = function () {

        // ç¶å®šè¡¨å–®æäº¤äº‹ä»¶
        document.getElementById('ageForm').addEventListener('submit', calculateHumanAge);

        // å–å¾—æ¬„ä½
        const birthInput = document.getElementById('birthDate');
        const weightInput = document.getElementById('weight');

        // ---------- è®€å– localStorage ----------
        const savedBirth = localStorage.getItem('dog_birth');
        const savedWeight = localStorage.getItem('dog_weight');

        if (savedBirth) birthInput.value = savedBirth;
        if (savedWeight) weightInput.value = savedWeight;

        // å¦‚æœä½ å¸Œæœ›è¼‰å…¥å¾Œè‡ªå‹•è¨ˆç®—ï¼Œå¯å°‡åº•ä¸‹è¨»è§£æ‰“é–‹
        // if (savedBirth && savedWeight) {
        //     calculateHumanAge(new Event('submit'));
        // }

        // ---------- è‡ªå‹•å„²å­˜åˆ° localStorage ----------
        birthInput.addEventListener('change', () => {
            localStorage.setItem('dog_birth', birthInput.value);
        });

        weightInput.addEventListener('input', () => {
            localStorage.setItem('dog_weight', weightInput.value);
        });
    };
    </script>
</head>

<body class="min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-lg">
        <div class="bg-white p-6 sm:p-8 rounded-2xl shadow-2xl">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">ğŸ¾ ç‹—ç‹—äººé¡å¹´é½¡æ›ç®—å™¨</h1>
            <p class="text-center text-gray-500 mb-6">æ ¹æ“šæ‚¨çš„ç‹—ç‹—çš„é«”å‹å’Œå¹´é½¡é€²è¡Œå°ˆæ¥­æ›ç®—ã€‚</p>

            <div id="notification" class="hidden p-3 mb-4 rounded-lg font-medium transition-all duration-300"
                role="alert">
            </div>

            <form id="ageForm" class="space-y-6">
                <div>
                    <label for="birthDate" class="block text-sm font-medium text-gray-700 mb-1">ç‹—ç‹—å‡ºç”Ÿå¹´æœˆæ—¥
                        (YYYY/MM/DD)</label>
                    <input type="date" id="birthDate" name="birthDate" required
                        class="w-full p-3 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                </div>

                <div>
                    <label for="weight" class="block text-sm font-medium text-gray-700 mb-1">ç‹—ç‹—é«”é‡ (å…¬æ–¤ kg)</label>
                    <div class="relative">
                        <input type="number" id="weight" name="weight" required min="0.1" step="0.1"
                            placeholder="ä¾‹å¦‚ï¼š15.5"
                            class="w-full p-3 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 pr-12 transition duration-150">
                        <span class="absolute right-0 top-0 mt-3 mr-3 text-gray-500 font-semibold">kg</span>
                    </div>
                </div>

                <button type="submit"
                    class="w-full py-3 px-4 bg-blue-600 text-white font-bold rounded-xl shadow-lg hover:bg-blue-700 transition duration-300 transform hover:scale-[1.02] active:scale-[0.98] focus:outline-none focus:ring-4 focus:ring-blue-300">
                    è¨ˆç®—äººé¡å¹´é½¡
                </button>
            </form>

            <hr class="my-8 border-gray-200">

            <div id="result" class="min-h-[100px] flex items-center justify-center">
                <p class="text-lg text-gray-400">è«‹è¼¸å…¥è³‡è¨Šä¸¦é»æ“Šè¨ˆç®—æŒ‰éˆ•ã€‚</p>
            </div>
        </div>

        <!-- ç‰ˆæ¬Šè²æ˜ -->
        <div class="mt-6 text-center">
            <p
                class="text-sm font-medium bg-white/20 backdrop-blur-sm rounded-lg px-4 py-2 inline-block shadow-lg bg-gradient-to-r from-orange-500 to-red-500 bg-clip-text text-transparent">
                Â© 2025 åœˆåœˆè£½ä½œ | Made with â¤ï¸
            </p>
        </div>
    </div>

</body>

</html>